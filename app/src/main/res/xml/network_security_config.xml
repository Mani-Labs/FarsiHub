<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <!--
        SECURITY: HTTPS-only enforcement for all content domains
        Issue: M9 - Prevent man-in-the-middle attacks

        EXTERNAL AUDIT VERIFIED S9 (2025-11-21): Cleartext Traffic Conflict - RESOLVED
        Issue: SecureUrlValidator permits HTTP_ALLOWED_DOMAINS, but OS may block at socket level
        Solution: network_security_config properly configured with cleartextTrafficPermitted="false"
        Verification: Lines 14-30 enforce HTTPS for all domains (farsiland, farsiplex, namakade, CDNs)
        Result: No conflict - HTTP_ALLOWED_DOMAINS list is empty, all traffic requires HTTPS

        All content providers must serve content over HTTPS to protect:
        - Video stream URLs from interception
        - User viewing patterns from network observers
        - Application from content substitution attacks
    -->

    <!-- Primary content domains - HTTPS enforced -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">farsiland.com</domain>
        <domain includeSubdomains="true">farsiplex.com</domain>
        <domain includeSubdomains="true">namakade.com</domain>
    </domain-config>

    <!-- CDN domains - HTTPS enforced -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">flnd.buzz</domain>
        <domain includeSubdomains="true">d1.flnd.buzz</domain>
        <domain includeSubdomains="true">d2.flnd.buzz</domain>
    </domain-config>

    <!-- WordPress API endpoint - HTTPS enforced -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">wp.farsiland.com</domain>
    </domain-config>

    <!-- Default: Block all cleartext traffic for any other domains -->
    <base-config cleartextTrafficPermitted="false">
        <trust-anchors>
            <!-- Trust system-installed CA certificates -->
            <certificates src="system" />
        </trust-anchors>
    </base-config>

    <!--
        Debug configuration for development/testing
        Uncomment to allow user-installed CA certificates (e.g., Charles Proxy, mitmproxy)
        WARNING: NEVER enable this in production builds!
    -->
    <!--
    <debug-overrides>
        <trust-anchors>
            <certificates src="user" />
            <certificates src="system" />
        </trust-anchors>
    </debug-overrides>
    -->
</network-security-config>
