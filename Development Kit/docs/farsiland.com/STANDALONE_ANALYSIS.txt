FARSILAND.COM STANDALONE ANDROID TV APP - TECHNICAL ANALYSIS

EXECUTIVE SUMMARY
==================

Farsiland.com is fully scrapable without any backend server required.

Key Facts:
1. WordPress REST API for content listing (public, no authentication)
2. HTML microdata for video URLs
3. CDN mirrors (d1.flnd.buzz, d2.flnd.buzz) for video delivery
4. All components accessible from standalone Android TV app

CRITICAL FINDING: No backend server needed for full functionality.

---

1. WORDPRESS REST API ENDPOINTS
================================

Available:
- /wp-json/wp/v2/movies?per_page=50&page=1
- /wp-json/wp/v2/tvshows?per_page=50&page=1
- /wp-json/wp/v2/episodes?per_page=50
- /wp-json/wp/v2/genres?per_page=100
- /wp-json/wp/v2/media/{ID}

All return JSON, require NO authentication.

Movie/TV Response Contains:
- id, title, link, featured_media (image ID)
- genres (IDs to resolve), dtcast, dtdirector/dtcreator
- dtyear (year ID), content (plot), slug, status

LIMITATION: Episodes endpoint does NOT provide parent series info.
SOLUTION: Must HTML scrape series page to get episode lists.

---

2. VIDEO URL EXTRACTION
=======================

Location: <link itemprop="contentUrl" href="..."> on episode pages

CDN URL Pattern:
https://{mirror}/series/{series_slug}/{episode:02d}.{quality}.mp4

Examples:
- https://d1.flnd.buzz/series/bamdade-khomar/01.1080.mp4
- https://d2.flnd.buzz/series/bamdade-khomar/01.720.mp4

Mirrors: d1.flnd.buzz (primary), d2.flnd.buzz (fallback)
Qualities: 1080p (.1080), 720p (.720), 480p (.480)

Special: Fractional episodes have format 01.5.1080.mp4

NO AUTHENTICATION REQUIRED for video URLs.

---

3. SERIES/EPISODE STRUCTURE
============================

Getting Episodes: Only via HTML scraping (REST API doesn't support this)

Steps:
1. Fetch /tvshows/{slug}/ page HTML
2. Parse <li class="mark-*"> elements
3. Extract episode from <div class="numerando">1 - 1</div> (format: season - episode)
4. Extract episode link and fetch episode page
5. Parse <link itemprop="contentUrl"> for video URLs

Rate Limit: Use 500ms delay between requests.

---

4. ANDROID TV APP MUST IMPLEMENT
=================================

HTTP Client:
- OkHttp3 with 30s timeout
- Retry logic with exponential backoff
- Network state detection

REST API Layer:
- Movies, tvshows, genres, media endpoints
- Pagination (per_page, page)
- Search and genre filtering
- Cache genres (load once)

HTML Scraper:
- Series page (get episodes)
- Episode page (extract video URLs)
- Series slug parser
- Season/episode parser
- Fractional episode detection
- Rate limiter (500ms)

Video URL Manager:
- URL pattern generator
- Mirror fallback logic
- Quality selection (1080p > 720p > 480p)
- URL verification
- Cache (24h TTL)

Database (Room):
- Movies, TVShows, Episodes, Genres
- Image cache (media_id -> URLs)
- Video URL cache (episode_id -> URLs)
- Watch history (optional)

UI (Android TV):
- Grid for movies/shows
- Series details, episode list
- ExoPlayer integration
- Genre filters, search
- Loading/error states

Performance:
- Image disk cache
- Genre in-memory cache
- Episode list cache (1 week)
- Lazy load thumbnails

Testing:
- Unit tests (parsing, URL generation)
- Integration tests (API, scraper)
- E2E tests (search to play)
- Performance benchmarks

---

5. MISSING INFORMATION
======================

NOT in REST API:
- Episode parent series
- Episode air dates
- Season count
- Subtitles
- Duration
- Ratings

Workaround: HTML scraping or calculate from data

---

6. RISKS & MITIGATIONS
======================

HTML Fragility: Use CSS classes, fallback to URL patterns
CDN Reliability: Try both mirrors, cache verified URLs
Rate Limiting: 500ms delays, batch ops, exponential backoff
Offline Mode: Cache popular content, limit to cached only
Geo-Blocking: Try both mirrors, user notification

---

7. CONFIDENCE ASSESSMENT
========================

REST API: HIGH (public, stable)
HTML Scraper: MEDIUM-HIGH (fragile but fixable)
Video URLs: HIGH (microdata + patterns)
OVERALL: HIGH - Fully feasible standalone app

---

8. DEPLOYMENT
==============

Target: Android TV (API 21+, recommended 27+)
Player: ExoPlayer
Size: 20-40 MB
Permissions: INTERNET, ACCESS_NETWORK_STATE
Testing: Android TV emulator

---

Next Step: Begin Phase 1 Implementation
